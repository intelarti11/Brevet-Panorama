
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Demandes d'invitation :
    // - Tout le monde peut en créer une (pour la page de demande).
    // - Seul l'admin peut lire la liste, la mettre à jour ou la supprimer.
    match /invitationRequests/{requestId} {
      allow read, update, delete: if request.auth != null && request.auth.token.email == 'florent.romero@ac-montpellier.fr';
      allow create: if true;
    }

    // Résultats du brevet :
    // - Tous les utilisateurs connectés peuvent lire les données (pour les dashboards).
    // - Seul l'admin peut écrire/importer des données.
    match /brevetResults/{resultId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && request.auth.token.email == 'florent.romero@ac-montpellier.fr';
    }

    // Données pour le Brevet Blanc (listes d'élèves, etc.)
    // - Tous les utilisateurs connectés peuvent les lire.
    // - Seul l'admin peut écrire/importer des données.
    match /BrevetBlanc/{studentId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && request.auth.token.email == 'florent.romero@ac-montpellier.fr';
    }
  }
}
